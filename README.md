Vulnerability Assessment of the Network using Port Documentation
Introduction

The "Vulnerability Assessment of the Network using Port" script is a Python script designed to perform vulnerability assessments on a network by scanning specific IP addresses within a given range on a specified port. It uses the Greenbone Vulnerability Management (GVM) library to establish connections with the network, authenticate, and scan for vulnerabilities. This documentation provides a comprehensive overview of the script's code structure, usage, and functionality.
Getting Started

To use the "Vulnerability Assessment of the Network using Port" script, follow these steps:

    Install the GVM Python library by running the following command:

pip install gvm-tools

Clone or download this repository to your local machine.

Open the Python script in your preferred code editor or integrated development environment (IDE).

Execute the script using the following command:

    python network_vulnerability_assessment.py

    Follow the script's prompts: You will be asked to provide details of the network to be assessed, including the network's IP address range, the target host, the port number to scan, the username for authentication, and the password for authentication.

Code Structure

The "Vulnerability Assessment of the Network using Port" script consists of the following components:
1. network_detail Function

# Function for input network detail
def network_detail():
    # Prompt user to enter detail
    print("Please Enter the details of the network.....")
    network_address = input("Enter the IP address: ")
    host = input("Enter the host: ")
    port = int(input("Enter the port number to scan: "))
    username = input("Enter the username of the network: ")
    password = input("Enter the password of the network: ")

    return network_address, host, port, username, password

This function collects user input for network details, including the IP address, target host, port number, username, and password.
2. authentication_and_task Function


# Function to scan network on a specific port
def authentication_and_task(ip_network, port, host_name, username, password):
    # Establish Connection
    connection = gvm.connections.TLSConnection(hostname=host_name)
    with Gmp(connection=connection) as gmp:
        # Authenticate credentials
        gmp.authenticate(username, password)

        # Generate a list of IP addresses within the IP range
        ip_list = list(ip_network.hosts())

        for ip_address in ip_list:
            str_ip = str(ip_address)

            # Create a target for the scan with the specific port
            target = gmp.create_target(f"Target {str_ip}:{port}", hosts=str_ip, ports=f"{port}")

            # Create a task for the scan
            task = gmp.create_task(f"Scan {str_ip}:{port}", target_id=target.id)

            # Start the scan
            gmp.start_task(task.id)

            # Wait for the scan to complete
            scan_network(gmp, task, str_ip, port)

This function establishes a connection to the GVM, authenticates the user's credentials, generates a list of IP addresses within the specified range, creates a target for the scan on the given port, initiates a task for the scan, and starts the scan process.
3. scan_network Function


# Function for scanning the network
def scan_network(gmp, task, str_ip, port):
    while True:
        task = gmp.get_task(task.id)
        if task.status in ['New', 'Running']:
            print("Scan in progress...")
        elif task.status == 'Done':
            print("Scan completed.")
            break
        else:
            raise Exception(f"Scan failed with status: {task.status}")

This function continuously checks the status of the scan task and provides feedback to the user on whether the scan is in progress or has completed.
4. retrieve_result Function


# Function for retrieving scan results
def retrieve_result(gmp, task, str_ip, port):
    results = gmp.get_report_formats()
    for result in results:
        if result.name == 'HTML':
            report = gmp.get_report(task.id, result.id)
            with open(f"scan_results_{str_ip}_{port}.html", "wb") as file:
                file.write(report)

This function retrieves the scan results, including any HTML reports generated during the scan, and saves them to a file with a specific filename.
5. Main Execution Block


if __name__ == "__main__":
    # Prompt user to enter network detail
    network_address, host, port, username, password = network_detail()

    # Convert network address to an IP network object
    ip_network = ipaddress.ip_network(network_address)

    # Scan the network
    authentication_and_task(ip_network, port, host, username, password)

The main execution block prompts the user to input network details, converts the network address to an IP network object, and initiates the network vulnerability assessment by calling the authentication_and_task function.
Usage

    Run the Python script as described in the "Getting Started" section.

    Provide the requested network details when prompted, including the IP address range, target host, port number, username, and password.

    Wait for the scan to complete. The script will provide feedback on the scan's progress.

    Retrieve and review the scan results. The HTML reports generated during the scan can be found in files named according to the scanned IP addresses and ports.

Conclusion

This documentation serves as a comprehensive guide to the "Vulnerability Assessment of the Network using Port" script, enabling you to perform vulnerability assessments on a network by scanning specific IP addresses within a given range on a specified port. The script utilizes the GVM library for network scanning and provides valuable feedback on the scan's progress and results.
